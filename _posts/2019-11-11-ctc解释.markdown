---
layout: post
title: ctc
date: "2019-11-11 14:00:000"
tags: [ctc]

---

## æµç¨‹:

*è½¬è½½æœ¬æ–‡è¯·æ³¨æ˜å‡ºå¤„ï¼š*[https://xiaodu.io/ctc-explained](http://xiaodu.io/ctc-explained)*ä½œè€…ï¼šyudonglee*

ç°å®åº”ç”¨ä¸­è®¸å¤šé—®é¢˜å¯ä»¥æŠ½è±¡ä¸ºåºåˆ—å­¦ä¹ ï¼ˆsequence learningï¼‰é—®é¢˜ï¼Œæ¯”å¦‚è¯æ€§æ ‡æ³¨ï¼ˆPOS Taggingï¼‰ã€è¯­éŸ³è¯†åˆ«ï¼ˆSpeech Recognitionï¼‰ã€æ‰‹å†™å­—è¯†åˆ«ï¼ˆHandwriting Recognitionï¼‰ã€æœºå™¨ç¿»è¯‘ï¼ˆMachine Translationï¼‰ç­‰åº”ç”¨ï¼Œå…¶æ ¸å¿ƒé—®é¢˜éƒ½æ˜¯è®­ç»ƒæ¨¡å‹æŠŠä¸€ä¸ªé¢†åŸŸçš„ï¼ˆè¾“å…¥ï¼‰åºåˆ—è½¬æˆå¦ä¸€ä¸ªé¢†åŸŸçš„ï¼ˆè¾“å‡ºï¼‰åºåˆ—ã€‚è¿‘å¹´æ¥åŸºäºRNNçš„åºåˆ—åˆ°åºåˆ—æ¨¡å‹ï¼ˆsequence-to-sequence modelsï¼‰åœ¨åºåˆ—å­¦ä¹ ä»»åŠ¡ä¸­å–å¾—äº†æ˜¾è‘—çš„æ•ˆæœæå‡ï¼Œæœ¬æ–‡ä»‹ç»ä¸€ç§RNNï¼ˆRecurrent Neural Networksï¼‰çš„ç«¯åˆ°ç«¯è®­ç»ƒæ–¹æ³•â€”â€”CTCï¼ˆConnectionist Temporal Classificationï¼‰ç®—æ³•ï¼Œå®ƒå¯ä»¥è®©RNNç›´æ¥å¯¹åºåˆ—æ•°æ®è¿›è¡Œå­¦ä¹ ï¼Œè€Œæ— éœ€äº‹å…ˆæ ‡æ³¨å¥½è®­ç»ƒæ•°æ®ä¸­è¾“å…¥åºåˆ—å’Œè¾“å‡ºåºåˆ—çš„æ˜ å°„å…³ç³»ï¼Œæ‰“ç ´äº†RNNåº”ç”¨äºè¯­éŸ³è¯†åˆ«ã€æ‰‹å†™å­—è¯†åˆ«ç­‰é¢†åŸŸçš„æ•°æ®ä¾èµ–çº¦æŸï¼Œä½¿å¾—RNNæ¨¡å‹åœ¨åºåˆ—å­¦ä¹ ä»»åŠ¡ä¸­å–å¾—æ›´å¥½çš„åº”ç”¨æ•ˆæœã€‚

æœ¬æ–‡æ€»å…±åˆ†ä¸ºäº”éƒ¨åˆ†æ¥å…¨é¢é˜è¿°CTCç®—æ³•ï¼ˆæœ¬ç¯‡ä¸ºPart 1ï¼‰ï¼š
**Part 1**ï¼šTraining the Networkï¼ˆè®­ç»ƒç®—æ³•ç¯‡ï¼‰ï¼Œä»‹ç»CTCç†è®ºåŸç†ï¼ŒåŒ…æ‹¬é—®é¢˜å®šä¹‰ã€å…¬å¼æ¨å¯¼ã€ç®—æ³•è¿‡ç¨‹ç­‰ã€‚[Part 1é“¾æ¥](https://xiaodu.io/ctc-explained)ã€‚
**Part 2**ï¼šDecoding the Networkï¼ˆè§£ç ç®—æ³•ç¯‡ï¼‰ï¼Œä»‹ç»CTC Decodingçš„å‡ ç§å¸¸ç”¨ç®—æ³•ã€‚[Part 2é“¾æ¥](https://xiaodu.io/ctc-explained-part2/)ã€‚
**Part 3**ï¼šCTC Demo by Speech Recognitionï¼ˆCTCè¯­éŸ³è¯†åˆ«å®æˆ˜ç¯‡ï¼‰ï¼ŒåŸºäºTensorFlowå®ç°çš„è¯­éŸ³è¯†åˆ«ä»£ç ï¼ŒåŒ…å«è¯¦ç»†çš„ä»£ç å®æˆ˜è®²è§£ã€‚Part 3é“¾æ¥ã€‚
**Part 4**ï¼šCTC Demo by Handwriting Recognitionï¼ˆCTCæ‰‹å†™å­—è¯†åˆ«å®æˆ˜ç¯‡ï¼‰ï¼ŒåŸºäºTensorFlowå®ç°çš„æ‰‹å†™å­—è¯†åˆ«ä»£ç ï¼ŒåŒ…å«è¯¦ç»†çš„ä»£ç å®æˆ˜è®²è§£ã€‚Part 4é“¾æ¥ã€‚
**Part 5**ï¼šConclusionï¼ˆæ€»ç»“å±•æœ›ç¯‡ï¼‰ï¼Œæ€»ç»“CTCç®—æ³•çš„ç†è®ºå±€é™æ€§å’Œé€‚ç”¨åœºæ™¯ï¼Œä»¥åŠè¿‘å¹´æ¥ç›¸å…³çš„æœ€æ–°ç ”ç©¶åŠ¨æ€ã€‚Part 5é“¾æ¥ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆä»â€œé—®é¢˜â€çš„èƒŒæ™¯è¯´èµ·ã€‚

#### 1. èƒŒæ™¯ä»‹ç»

åœ¨åºåˆ—å­¦ä¹ ä»»åŠ¡ä¸­ï¼ŒRNNæ¨¡å‹å¯¹è®­ç»ƒæ ·æœ¬ä¸€èˆ¬æœ‰è¿™æ ·çš„ä¾èµ–æ¡ä»¶ï¼šè¾“å…¥åºåˆ—å’Œè¾“å‡ºåºåˆ—ä¹‹é—´çš„æ˜ å°„å…³ç³»å·²ç»äº‹å…ˆæ ‡æ³¨å¥½äº†ã€‚æ¯”å¦‚ï¼Œåœ¨è¯æ€§æ ‡æ³¨ä»»åŠ¡ä¸­ï¼Œè®­ç»ƒæ ·æœ¬ä¸­æ¯ä¸ªè¯ï¼ˆæˆ–çŸ­è¯­ï¼‰å¯¹åº”çš„è¯æ€§ä¼šäº‹å…ˆæ ‡æ³¨å¥½ï¼Œå¦‚ä¸‹å›¾ï¼ˆDTã€NNç­‰éƒ½æ˜¯è¯æ€§çš„æ ‡æ³¨ï¼Œå…·ä½“å«ä¹‰è¯·å‚è€ƒ[é“¾æ¥](https://www.ling.upenn.edu/courses/Fall_2003/ling001/penn_treebank_pos.html)ï¼‰ã€‚ç”±äºè¾“å…¥åºåˆ—å’Œè¾“å‡ºåºåˆ—æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæ‰€ä»¥RNNæ¨¡å‹çš„è®­ç»ƒå’Œé¢„æµ‹éƒ½æ˜¯ç«¯åˆ°ç«¯çš„ï¼Œå³å¯ä»¥æ ¹æ®è¾“å‡ºåºåˆ—å’Œæ ‡æ³¨æ ·æœ¬é—´çš„å·®å¼‚æ¥ç›´æ¥å®šä¹‰RNNæ¨¡å‹çš„Losså‡½æ•°ï¼Œä¼ ç»Ÿçš„RNNè®­ç»ƒå’Œé¢„æµ‹æ–¹å¼å¯ç›´æ¥é€‚ç”¨ã€‚

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/rnn.png?w=525&ssl=1)

![img](https://i1.wp.com/xiaodu.io/wp-content/uploads/2018/07/pic1-1.png?w=525&ssl=1)

ç„¶è€Œï¼Œåœ¨è¯­éŸ³è¯†åˆ«ã€æ‰‹å†™å­—è¯†åˆ«ç­‰ä»»åŠ¡ä¸­ï¼Œç”±äºéŸ³é¢‘æ•°æ®å’Œå›¾åƒæ•°æ®éƒ½æ˜¯ä»ç°å®ä¸–ç•Œä¸­å°†æ¨¡æ‹Ÿä¿¡å·è½¬ä¸ºæ•°å­—ä¿¡å·é‡‡é›†å¾—åˆ°ï¼Œè¿™äº›æ•°æ®å¤©ç„¶å°±å¾ˆéš¾è¿›è¡Œâ€œåˆ†å‰²â€ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¾ˆéš¾è·å–åˆ°åŒ…å«è¾“å…¥åºåˆ—å’Œè¾“å‡ºåºåˆ—æ˜ å°„å…³ç³»çš„å¤§è§„æ¨¡è®­ç»ƒæ ·æœ¬ï¼ˆäººå·¥æ ‡æ³¨æˆæœ¬å·¨é«˜ï¼Œä¸”å¯å‘å¼æŒ–æ˜æ–¹æ³•å­˜åœ¨å¾ˆå¤§å±€é™æ€§ï¼‰ã€‚å› æ­¤ï¼Œåœ¨è¿™ç§æ¡ä»¶ä¸‹ï¼ŒRNNæ— æ³•ç›´æ¥è¿›è¡Œç«¯åˆ°ç«¯çš„è®­ç»ƒå’Œé¢„æµ‹ã€‚

å¦‚ä¸‹å›¾ï¼Œè¾“å…¥æ˜¯â€œappleâ€å¯¹åº”çš„ä¸€æ®µè¯´è¯éŸ³é¢‘å’Œæ‰‹å†™å­—å›¾ç‰‡ï¼Œä»è¿ç»­çš„éŸ³é¢‘ä¿¡å·å’Œå›¾åƒä¿¡å·ä¸­é€ä¸€åˆ†å‰²å¹¶æ ‡æ³¨å‡ºå¯¹åº”çš„è¾“å‡ºåºåˆ—éå¸¸è´¹æ—¶è´¹åŠ›ï¼Œåœ¨å¤§è§„æ¨¡è®­ç»ƒä¸‹è¿™ç§æ•°æ®è¦æ±‚æ˜¯å®Œå…¨ä¸åˆ‡å®é™…çš„ã€‚è€Œå¦‚æœè¾“å…¥åºåˆ—å’Œè¾“å‡ºåºåˆ—ä¹‹é—´æ˜ å°„å…³ç³»æ²¡æœ‰æå‰æ ‡æ³¨å¥½ï¼Œé‚£ä¼ ç»Ÿçš„RNNè®­ç»ƒæ–¹å¼å°±ä¸èƒ½ç›´æ¥é€‚ç”¨äº†ï¼Œæ— æ³•ç›´æ¥å¯¹éŸ³é¢‘æ•°æ®å’Œå›¾åƒæ•°æ®è¿›è¡Œè®­ç»ƒã€‚

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/r2.png?w=525&ssl=1)

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/r1.png?w=525&ssl=1)

å› æ­¤ï¼Œåœ¨è¯­éŸ³è¯†åˆ«ã€å›¾åƒè¯†åˆ«ç­‰é¢†åŸŸä¸­ï¼Œç”±äºæ•°æ®å¤©ç„¶æ— æ³•åˆ‡å‰²ï¼Œä¸”éš¾ä»¥æ ‡æ³¨å‡ºè¾“å…¥å’Œè¾“å‡ºçš„åºåˆ—æ˜ å°„å…³ç³»ï¼Œå¯¼è‡´ä¼ ç»Ÿçš„RNNè®­ç»ƒæ–¹æ³•ä¸èƒ½ç›´æ¥é€‚ç”¨ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•è®©RNNæ¨¡å‹å®ç°ç«¯åˆ°ç«¯çš„è®­ç»ƒæˆä¸ºäº†å…³é”®é—®é¢˜ã€‚

Connectionist Temporal Classificationï¼ˆCTCï¼‰[1]æ˜¯Alex Gravesç­‰äººåœ¨ICML 2006ä¸Šæå‡ºçš„ä¸€ç§ç«¯åˆ°ç«¯çš„RNNè®­ç»ƒæ–¹æ³•ï¼Œå®ƒå¯ä»¥è®©RNNç›´æ¥å¯¹åºåˆ—æ•°æ®è¿›è¡Œå­¦ä¹ ï¼Œè€Œæ— éœ€äº‹å…ˆæ ‡æ³¨å¥½è®­ç»ƒæ•°æ®ä¸­è¾“å…¥åºåˆ—å’Œè¾“å…¥åºåˆ—çš„æ˜ å°„å…³ç³»ï¼Œä½¿å¾—RNNæ¨¡å‹åœ¨è¯­éŸ³è¯†åˆ«ç­‰åºåˆ—å­¦ä¹ ä»»åŠ¡ä¸­å–å¾—æ›´å¥½çš„æ•ˆæœï¼Œåœ¨è¯­éŸ³è¯†åˆ«å’Œå›¾åƒè¯†åˆ«ç­‰é¢†åŸŸCTCç®—æ³•éƒ½æœ‰å¾ˆæ¯”è¾ƒå¹¿æ³›çš„åº”ç”¨ã€‚æ€»çš„æ¥è¯´ï¼ŒCTCçš„æ ¸å¿ƒæ€è·¯ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š

- å®ƒæ‰©å±•äº†RNNçš„è¾“å‡ºå±‚ï¼Œåœ¨è¾“å‡ºåºåˆ—å’Œæœ€ç»ˆæ ‡ç­¾ä¹‹é—´å¢åŠ äº†å¤šå¯¹ä¸€çš„ç©ºé—´æ˜ å°„ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šå®šä¹‰äº†CTC Losså‡½æ•°
- å®ƒå€Ÿé‰´äº†HMMï¼ˆHidden Markov Modelï¼‰çš„Forward-Backwardç®—æ³•æ€è·¯ï¼Œåˆ©ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•æœ‰æ•ˆåœ°è®¡ç®—CTC Losså‡½æ•°åŠå…¶å¯¼æ•°ï¼Œä»è€Œè§£å†³äº†RNNç«¯åˆ°ç«¯è®­ç»ƒçš„é—®é¢˜
- æœ€åï¼Œç»“åˆCTC Decodingç®—æ³•RNNå¯ä»¥æœ‰æ•ˆåœ°å¯¹åºåˆ—æ•°æ®è¿›è¡Œç«¯åˆ°ç«¯çš„é¢„æµ‹

æ¥ä¸‹æ¥ï¼Œé€šè¿‡ä¸€ä¸ªè¯­éŸ³è¯†åˆ«çš„å®é™…ä¾‹å­æ¥å¼•å‡ºCTCçš„è§£å†³æ€è·¯

#### 2. ä¸€ä¸ªå®é™…çš„ä¾‹å­â€“å£°å­¦æ¨¡å‹

è¯­éŸ³è¯†åˆ«çš„æ ¸å¿ƒé—®é¢˜æ˜¯æŠŠä¸€æ®µéŸ³é¢‘ä¿¡å·åºåˆ—è½¬åŒ–æ–‡å­—åºåˆ—ï¼Œä¼ ç»Ÿçš„è¯­éŸ³è¯†åˆ«ç³»ç»Ÿä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ éƒ¨åˆ†ï¼Œå¦‚ä¸‹å›¾ã€‚

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/asr.png?w=525&ssl=1)

å…¶ä¸­ï¼ŒXè¡¨ç¤ºéŸ³é¢‘ä¿¡å·ï¼ŒOæ˜¯å®ƒçš„ç‰¹å¾è¡¨ç¤ºï¼Œä¸€èˆ¬åŸºäºLPCã€MFCCç­‰æ–¹æ³•æå–ç‰¹å¾ï¼Œä¹Ÿå¯ä»¥åŸºäºDNNçš„æ–¹å¼â€œå­¦åˆ°â€å£°å­¦ç‰¹å¾çš„è¡¨ç¤ºã€‚ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬æš‚ä¸”æŠŠOç†è§£ä¸ºæ˜¯ç”±å®æ•°æ•°ç»„ç»„æˆçš„åºåˆ—ï¼Œå®ƒæ˜¯éŸ³é¢‘ä¿¡å·çš„ç‰¹å¾è¡¨ç¤ºã€‚Qæ˜¯Oå¯¹åº”çš„å‘éŸ³å­—ç¬¦åºåˆ—ï¼Œå³å»ºæ¨¡å•å…ƒï¼Œä¸€èˆ¬å¯ä»¥æ˜¯éŸ³ç´ ã€éŸ³èŠ‚ã€å­—ã€è¯ç­‰ã€‚Wæ˜¯éŸ³é¢‘ä¿¡å·Xå¯¹åº”çš„æ–‡å­—åºåˆ—ï¼Œå³æˆ‘ä»¬æœ€ç»ˆçš„è¯†åˆ«ç»“æœã€‚

å¦‚å›¾æ‰€ç¤ºï¼Œæ ¸å¿ƒé—®é¢˜æ˜¯é€šè¿‡è§£ç å™¨æ‰¾åˆ°ä»¤P(W|X)æœ€å¤§åŒ–çš„çš„Wï¼Œé€šè¿‡è´å¶æ–¯å…¬å¼å¯å°†å…¶åˆ†è§£ä¸ºP(O|Q)ã€P(Q|W)ã€P(W)ï¼Œåˆ†åˆ«å¯¹åº”å£°å­¦æ¨¡å‹ã€å‘éŸ³æ¨¡å‹ã€è¯­è¨€æ¨¡å‹ã€‚

å…¶ä¸­ï¼Œå£°å­¦æ¨¡å‹å°±æ˜¯å¯¹P(O|Q)è¿›è¡Œå»ºæ¨¡ï¼Œé€šè¿‡è®­ç»ƒå¯ä»¥â€œå­¦åˆ°â€éŸ³é¢‘ä¿¡å·å’Œæ–‡å­—å‘éŸ³é—´çš„è”ç³»ã€‚ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬å‡å®šå£°å­¦æ¨¡å‹çš„å»ºæ¨¡å•å…ƒQé€‰æ‹©çš„æ˜¯[éŸ³èŠ‚](https://baike.baidu.com/item/æ±‰è¯­æ‹¼éŸ³éŸ³èŠ‚/9167981)ï¼ŒOé€‰æ‹©çš„æ˜¯MFCCç‰¹å¾ï¼ˆç”±39ç»´æ•°ç»„ç»„æˆçš„åºåˆ—ï¼‰ã€‚

å¦‚ä¸‹å›¾ï¼Œè¾“å…¥åºåˆ—æ˜¯ä¸€æ®µâ€œæˆ‘çˆ±ä½ ä¸­å›½â€çš„éŸ³é¢‘ï¼Œè¾“å‡ºåºåˆ—æ˜¯éŸ³èŠ‚åºåˆ—â€œwo3 ai4 ni3 zhong1 guo2â€ï¼Œå¦‚æœè®­ç»ƒæ ·æœ¬ä¸­å·²ç»â€œåˆ†å‰²â€å¥½éŸ³é¢‘ï¼Œå¹¶æ ‡æ³¨å¥½å®ƒå’ŒéŸ³èŠ‚çš„å¯¹åº”å…³ç³»ï¼Œåˆ™RNNæ¨¡å‹å¦‚ä¸‹ï¼š

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/rnn1.png?w=525&ssl=1)

ç„¶è€Œï¼Œå¦‚å‰é¢æ‰€è¿°ï¼Œå¯¹éŸ³é¢‘â€œåˆ†å‰²â€å¹¶æ ‡æ³¨æ˜ å°„å…³ç³»çš„æ•°æ®ä¾èµ–æ˜¯ä¸åˆ‡å®é™…çš„ï¼Œå®é™…æƒ…å†µæ˜¯å¯¹éŸ³é¢‘æŒ‰ç…§æ—¶é—´çª—å£æ»‘åŠ¨æ¥æå–ç‰¹å¾ï¼Œæ¯”å¦‚æŒ‰ç…§æ¯10æ¯«ç§’éŸ³é¢‘æå–ç‰¹å¾å¾—åˆ°ä¸€ä¸ªNç»´æ•°ç»„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/rnn_example.png?resize=525%2C320&ssl=1)

ç”±äºäººè¯´è¯å‘éŸ³æ˜¯è¿ç»­çš„ï¼Œä¸”ä¸­é—´ä¹Ÿä¼šæœ‰â€œåœé¡¿â€ï¼Œæ‰€ä»¥è¾“å‡ºåºåˆ—ä¸­å­˜åœ¨é‡å¤çš„å…ƒç´ ï¼Œæ¯”å¦‚â€œwo3 wo3â€ï¼Œä¹Ÿå­˜åœ¨è¡¨ç¤ºé—´éš”ç¬¦å·â€œ_â€ã€‚éœ€ä»è¾“å‡ºåºåˆ—ä¸­å»é™¤æ‰é‡å¤çš„å…ƒç´ ä»¥åŠé—´éš”ç¬¦ï¼Œæ‰å¯å¾—åˆ°æœ€ç»ˆçš„éŸ³èŠ‚åºåˆ—ï¼Œæ¯”å¦‚ï¼Œâ€œwo3 wo3 ai4 _ ni3 _ zhong1 guo2 _â€ å½’ä¸€å¤„ç†åå¾—åˆ°â€œwo3 ai4 ni3 zhong1 guo2â€ã€‚å› æ­¤ï¼Œè¾“å‡ºåºåˆ—å’Œæœ€ç»ˆçš„labelä¹‹é—´å­˜åœ¨å¤šå¯¹ä¸€çš„æ˜ å°„å…³ç³»ï¼Œå¦‚ä¸‹å›¾ï¼š

![img](https://i1.wp.com/xiaodu.io/wp-content/uploads/2018/07/rnn_label.png?resize=525%2C278&ssl=1)

RNNæ¨¡å‹æœ¬è´¨æ˜¯å¯¹ğ’‘(ğ’›â”‚ğ’™)å»ºæ¨¡ï¼Œå…¶ä¸­xè¡¨ç¤ºè¾“å…¥åºåˆ—ï¼Œoè¡¨ç¤ºè¾“å‡ºåºåˆ—ï¼Œzè¡¨ç¤ºæœ€ç»ˆçš„labelï¼Œoå’Œlå­˜åœ¨å¤šå¯¹ä¸€çš„æ˜ å°„å…³ç³»ï¼Œå³ï¼šğ’‘(ğ’›â”‚ğ’™)=sum of all P(o|x)ï¼Œå…¶ä¸­oæ˜¯æ‰€æœ‰æ˜ å°„åˆ°zçš„è¾“å‡ºåºåˆ—ã€‚å› æ­¤ï¼Œåªéœ€è¦ç©·ä¸¾å‡ºæ‰€æœ‰çš„oï¼Œç´¯åŠ ä¸€èµ·å³å¯å¾—åˆ°ğ’‘(ğ’›â”‚ğ’™)ï¼Œä»è€Œä½¿å¾—RNNæ¨¡å‹å¯¹æœ€ç»ˆçš„labelè¿›è¡Œå»ºæ¨¡ã€‚

ç»è¿‡ä»¥ä¸Šçš„æ˜ å°„è½¬æ¢ï¼Œè§£å†³äº†ç«¯åˆ°ç«¯è®­ç»ƒçš„é—®é¢˜ï¼ŒRNNæ¨¡å‹å®é™…ä¸Šæ˜¯å¯¹æ˜ å°„åˆ°æœ€ç»ˆlabelçš„è¾“å‡ºåºåˆ—çš„ç©ºé—´å»ºæ¨¡ã€‚ç„¶è€Œï¼Œå¯¹æ¯ä¸€ä¸ªzéƒ½â€œç©·ä¸¾æ‰€æœ‰çš„oâ€ï¼Œè¿™ä¸ªè®¡ç®—çš„å¤æ‚åº¦å¤ªå¤§ï¼Œä¼šä½¿å¾—è®­ç»ƒé€Ÿåº¦å˜å¾—éå¸¸æ…¢ï¼Œå› æ­¤æ€ä¹ˆæ›´é«˜æ•ˆåœ°è¿›è¡Œç«¯åˆ°ç«¯è®­ç»ƒæˆä¸ºå¾…è§£å†³çš„å…³é”®é—®é¢˜ã€‚

é€šè¿‡ä»¥ä¸Šçš„å®é™…ä¾‹å­ï¼Œæˆ‘ä»¬å¯¹é—®é¢˜çš„è§£å†³æ€è·¯æœ‰äº†æ›´åŠ ç›´è§‚çš„äº†è§£ï¼Œæ¥ä¸‹æ¥å°±å¼€å§‹æ­£å¼ä»‹ç»CTCçš„ç†è®ºåŸç†ã€‚

#### 3. é—®é¢˜å®šä¹‰

ä»¥RNNå£°å­¦æ¨¡å‹ä¸ºä¾‹å­ï¼Œå»ºæ¨¡çš„ç›®æ ‡æ˜¯é€šè¿‡è®­ç»ƒå¾—åˆ°ä¸€ä¸ªRNNæ¨¡å‹ï¼Œä½¿å…¶æ»¡è¶³ï¼š

![img](https://i1.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_def.png?w=525&ssl=1)

æœ¬è´¨ä¸Šæ˜¯æœ€å¤§ä¼¼ç„¶é¢„ä¼°ï¼Œ Sæ˜¯è®­ç»ƒæ•°æ®é›†ï¼ŒXå’ŒZåˆ†åˆ«æ˜¯è¾“å…¥ç©ºé—´ï¼ˆç”±éŸ³é¢‘ä¿¡å·å‘é‡åºåˆ—ç»„æˆçš„é›†åˆï¼‰å’Œç›®æ ‡ç©ºé—´ï¼ˆç”±å£°å­¦æ¨¡å‹å»ºæ¨¡å•å…ƒåºåˆ—ç»„æˆçš„é›†åˆï¼‰ï¼ŒLæ˜¯ç”±è¾“å‡ºçš„å­—ç¬¦é›†ï¼ˆå£°å­¦å»ºæ¨¡å•å…ƒçš„é›†åˆï¼‰ï¼Œä¸”xçš„åºåˆ—é•¿åº¦å°äºæˆ–ç­‰äºzçš„åºåˆ—é•¿åº¦ã€‚

æ¥ä¸‹æ¥ï¼Œåœ¨ä»‹ç»å¦‚ä½•è®¡ç®—Losså‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å¯¹RNNè¾“å‡ºå±‚åšä¸€ä¸ªç®€å•çš„æ‰©å±•ã€‚

#### 4. RNNè¾“å‡ºå±‚æ‰©å±•

å¦‚ä¸‹å›¾ï¼Œä¸ºäº†ä¾¿äºè¯»è€…ç†è§£ï¼Œç®€åŒ–äº†RNNçš„ç»“æ„ï¼Œåªæœ‰å•å‘çš„ä¸€å±‚LSTMï¼ŒæŠŠå£°å­¦å»ºæ¨¡å•å…ƒé€‰æ‹©ä¸ºå­—æ¯{a-z}ï¼Œå¹¶å¯¹å»ºæ¨¡å•å…ƒå­—ç¬¦é›†åšäº†æ‰©å±•ï¼Œä¸”å®šä¹‰äº†ä»è¾“å‡ºå±‚åˆ°æœ€ç»ˆlabelåºåˆ—çš„å¤šå¯¹ä¸€æ˜ å°„å‡½æ•°ï¼Œä½¿å¾—RNNè¾“å‡ºå±‚èƒ½æ˜ å°„åˆ°æœ€ç»ˆçš„labelåºåˆ—ã€‚

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/rnn_out.png?w=525&ssl=1)

æ‰€ä»¥ï¼Œå¦‚æœè¦è®¡ç®—ğ’‘(ğ’›â”‚ğ’™)ï¼Œå¯ä»¥ç´¯åŠ å…¶å¯¹åº”çš„å…¨éƒ¨è¾“å‡ºåºåˆ—(ä¹Ÿå³æ˜ å°„åˆ°æœ€ç»ˆlabelçš„â€œè·¯å¾„â€)çš„æ¦‚ç‡å³å¯ï¼Œå¦‚ä¸‹å›¾ã€‚

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_mapping.png?w=525&ssl=1)

#### 5. CTC Losså‡½æ•°å®šä¹‰

å¦‚ä¸‹å›¾ï¼ŒåŸºäºRNNæ¡ä»¶ç‹¬ç«‹å‡è®¾ï¼Œå³å¯å¾—åˆ°CTC Losså‡½æ•°çš„å®šä¹‰ï¼š

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_fun.png?resize=525%2C268&ssl=1)

å‡å®šé€‰æ‹©å•å±‚LSTMä¸ºRNNç»“æ„ï¼Œåˆ™æœ€ç»ˆçš„æ¨¡å‹ç»“æ„å¦‚ä¸‹å›¾ï¼š

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/rnn_all.png?resize=525%2C293&ssl=1)

#### 6. CTC Losså‡½æ•°è®¡ç®—

ç”±äºç›´æ¥æš´åŠ›è®¡ç®— ğ’‘(ğ’›â”‚ğ’™)çš„å¤æ‚åº¦éå¸¸é«˜ï¼Œä½œè€…å€Ÿé‰´HMMçš„Forward-Backwardç®—æ³•æ€è·¯ï¼Œåˆ©ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•æ±‚è§£ã€‚

å¦‚ä¸‹å›¾ï¼Œä¸ºäº†æ›´å½¢è±¡è¡¨ç¤ºé—®é¢˜çš„æœç´¢ç©ºé—´ï¼Œç”¨Xè½´è¡¨ç¤ºæ—¶é—´åºåˆ—ï¼Œ Yè½´è¡¨ç¤ºè¾“å‡ºåºåˆ—ï¼Œå¹¶æŠŠè¾“å‡ºåºåˆ—åšæ ‡å‡†åŒ–å¤„ç†ï¼Œè¾“å‡ºåºåˆ—ä¸­é—´å’Œå¤´å°¾éƒ½åŠ ä¸Šblankï¼Œç”¨*l*è¡¨ç¤ºæœ€ç»ˆæ ‡ç­¾ï¼Œ*lâ€™*è¡¨ç¤ºæ‰©å±•åçš„å½¢å¼ï¼Œåˆ™ç”±2|*l*| + 1 = 2|*lâ€™*|ï¼Œæ¯”å¦‚ï¼š*l=*apple => *lâ€™=*_a_p_p_l_e_

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_apple1.png?resize=525%2C306&ssl=1)

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_apple2.png?resize=525%2C369&ssl=1)

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_apple3.png?resize=525%2C352&ssl=1)

å›¾ä¸­å¹¶ä¸æ˜¯æ‰€æœ‰çš„è·¯å¾„éƒ½æ˜¯åˆæ³•è·¯å¾„ï¼Œæ‰€æœ‰çš„åˆæ³•è·¯å¾„éœ€è¦éµå¾ªä¸€äº›çº¦æŸï¼Œå¦‚ä¸‹å›¾ï¼š

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_path1.png?resize=525%2C293&ssl=1)

![img](https://i1.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_path2.png?resize=525%2C296&ssl=1)

![img](https://i1.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_path3.png?resize=525%2C298&ssl=1)

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_path4.png?resize=525%2C297&ssl=1)

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_path5.png?resize=525%2C298&ssl=1)

æ‰€ä»¥ï¼Œä¾æ®ä»¥ä¸Šçº¦æŸè§„åˆ™ï¼Œéå†æ‰€æœ‰æ˜ å°„ä¸ºâ€œappleâ€çš„åˆæ³•è·¯å¾„ï¼Œæœ€ç»ˆæ—¶åºT=8ï¼Œæ ‡ç­¾labeling=â€œappleâ€çš„å…¨éƒ¨è·¯å¾„å¦‚ä¸‹å›¾ï¼š

![img](https://i1.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_path_apple.png?resize=525%2C347&ssl=1)

æ¥ä¸‹æ¥ï¼Œå¦‚ä½•è®¡ç®—è¿™äº›è·¯å¾„çš„æ¦‚ç‡æ€»å’Œï¼Ÿæš´åŠ›éå†ï¼Ÿåˆ†è€Œæ²»ä¹‹ï¼Ÿä½œè€…å€Ÿé‰´HMMçš„Forward-Backwardç®—æ³•æ€è·¯ï¼Œåˆ©ç”¨åŠ¨æ€è§„åˆ’ç®—æ³•æ±‚è§£ï¼Œå¯ä»¥å°†è·¯å¾„é›†åˆåˆ†ä¸ºå‰å‘å’Œåå‘ä¸¤éƒ¨åˆ†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_a1.png?resize=525%2C296&ssl=1)

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_a2.png?resize=525%2C294&ssl=1)

![img](https://i1.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_a3.png?resize=525%2C293&ssl=1)

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_a4.png?resize=525%2C296&ssl=1)

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_a5.png?resize=525%2C297&ssl=1)

é€šè¿‡åŠ¨æ€è§„åˆ’æ±‚è§£å‡ºå‰å‘æ¦‚ç‡ä¹‹åï¼Œå¯ä»¥ç”¨å‰å‘æ¦‚ç‡æ¥è®¡ç®—CTC Losså‡½æ•°ï¼Œå¦‚ä¸‹å›¾ï¼š

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_a.png?resize=525%2C297&ssl=1)

ç±»ä¼¼åœ°æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰åå‘æ¦‚ç‡ï¼Œå¹¶ç”¨åå‘æ¦‚ç‡æ¥è®¡ç®—CTC Losså‡½æ•°ï¼Œå¦‚ä¸‹å›¾ï¼š

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_b1.png?resize=525%2C297&ssl=1)

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_b2.png?resize=525%2C296&ssl=1)

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_b3.png?resize=525%2C298&ssl=1)

å»æ‰ç®­å¤´æ–¹å‘ï¼ŒæŠŠå‰å‘æ¦‚ç‡å’Œåå‘æ¦‚ç‡ç»“åˆèµ·æ¥ä¹Ÿå¯ä»¥è®¡ç®—CTC Losså‡½æ•°ï¼Œè¿™å¯¹äºåé¢CTC Losså‡½æ•°æ±‚å¯¼è®¡ç®—æ˜¯ååˆ†é‡è¦çš„ä¸€æ­¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![img](https://i1.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_ab1.png?resize=525%2C293&ssl=1)

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_ab2.png?resize=525%2C298&ssl=1)

![img](https://i1.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_ab3.png?resize=525%2C298&ssl=1)

æ€»ç»“ä¸€ä¸‹ï¼Œæ ¹æ®å‰å‘æ¦‚ç‡è®¡ç®—CTC Losså‡½æ•°ï¼Œå¾—åˆ°ä»¥ä¸‹ç»“è®ºï¼š

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_af.png?resize=525%2C254&ssl=1)

æ ¹æ®åå‘æ¦‚ç‡è®¡ç®—CTC Losså‡½æ•°ï¼Œå¾—åˆ°ä»¥ä¸‹ç»“è®ºï¼š

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_bf.png?resize=525%2C273&ssl=1)

æ ¹æ®ä»»æ„æ—¶åˆ»çš„å‰å‘æ¦‚ç‡å’Œåå‘æ¦‚ç‡è®¡ç®—CTC Losså‡½æ•°ï¼Œå¾—åˆ°ä»¥ä¸‹ç»“è®ºï¼š

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_abf.png?resize=525%2C166&ssl=1)

è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å¾—åˆ°CTC Lossçš„æœ‰æ•ˆè®¡ç®—æ–¹æ³•ï¼Œæ¥ä¸‹æ¥å¯¹å…¶è¿›è¡Œæ±‚å¯¼

#### 7. CTC Losså‡½æ•°æ±‚å¯¼

æˆ‘ä»¬å…ˆå›é¡¾ä¸‹RNNçš„ç½‘ç»œç»“æ„ï¼Œå¦‚ä¸‹å›¾é£˜çº¢éƒ¨åˆ†æ˜¯CTC Losså‡½æ•°æ±‚å¯¼çš„æ ¸å¿ƒéƒ¨åˆ†ï¼š

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/rnn_of.png?resize=525%2C292&ssl=1)

CTC Losså‡½æ•°ç›¸å¯¹äºRNNè¾“å‡ºå±‚å…ƒç´ çš„æ±‚å¯¼è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![img](https://i2.wp.com/xiaodu.io/wp-content/uploads/2018/07/rnn_of2.png?resize=525%2C274&ssl=1)

![img](https://i1.wp.com/xiaodu.io/wp-content/uploads/2018/07/rnn_of3.png?resize=525%2C231&ssl=1)

#### 8. æ€»ç»“

æ€»ç»“ä¸€ä¸‹ï¼Œæœ¬ç¯‡é€šè¿‡RNNå£°å­¦æ¨¡å‹çš„ä¾‹å­å¼•å‡ºäº†é—®é¢˜èƒŒæ™¯ï¼Œå¹¶é€šè¿‡å®é™…ä¾‹å­ä¸€æ­¥ä¸€æ­¥çš„ä»‹ç»å¦‚ä½•å®šä¹‰å’Œè®¡ç®—CTC Losså‡½æ•°ï¼Œæœ€ç»ˆé€šè¿‡åå‘ä¼ æ’­ç®—æ³•å®Œæˆå¯¹RNNæ¨¡å‹çš„ç«¯åˆ°ç«¯è®­ç»ƒè¿‡ç¨‹ã€‚

![img](https://i0.wp.com/xiaodu.io/wp-content/uploads/2018/07/ctc_train3.png?w=525&ssl=1)

è‡³æ­¤ï¼ŒCTCç®—æ³•çš„æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸åŸç†ä»‹ç»å®Œäº†ï¼Œä¸‹ä¸€ç¯‡å°†ä»‹ç»CTCç®—æ³•çš„æ¨¡å‹é¢„æµ‹éƒ¨åˆ†ï¼Œ[Part2é“¾æ¥](https://xiaodu.io/ctc-explained-part2/)ã€‚

#### References

1. *Graves et al., Connectionist Temporal Classification: Labelling Unsegmented Sequence Data with RNNs. In ICML, 2006.* ï¼ˆGravesæå‡ºCTCç®—æ³•çš„åŸå§‹è®ºæ–‡ï¼‰
2. *Graves et al., A Novel Connectionist System for Unconstrained Handwriting Recognition. In IEEE Transactions on PAML, 2009.*ï¼ˆCTCç®—æ³•åœ¨æ‰‹å†™å­—è¯†åˆ«ä¸­çš„åº”ç”¨ï¼‰
3. *Graves et al., Towards End-to-End Recognition with RNNs. In JMLR, 2014.*ï¼ˆCTCç®—æ³•åœ¨ç«¯åˆ°ç«¯å£°å­¦æ¨¡å‹ä¸­çš„åº”ç”¨ï¼‰
4. *Alex Graves, Supervised Sequence Labelling with Recurrent Neural Networks. In Studies in Computational Intelligence, Springer, 2012.*ï¼ˆ Graves çš„åšå£«è®ºæ–‡ï¼Œå…³äºsequence learningçš„ç ”ç©¶ï¼Œä¸»è¦æ˜¯CTCï¼‰

